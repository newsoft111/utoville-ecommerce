{% extends 'base.html' %}
{% block content %}
{% load static %}
{% load humanize %}


<!--Page header start-->
<section class="position-relative overflow-hidden">
	<div class="py-8 py-lg-11 bg-dark text-white position-relative">
		<!--background image-->
		<img src="{% static 'img/shop/banners/06.jpg' %}" class="bg-image bg-top-center opacity-75" alt="">
	
		<div class="row align-items-center position-relative">
		<div class="col-lg-10 mx-auto text-center">
			<nav class="d-flex justify-content-center" aria-label="breadcrumb">
			<ol class="breadcrumb mb-3">
				<li class="breadcrumb-item">
				<a href="#!">Home</a>
				</li>
				<li class="breadcrumb-item active">
				Shop
				</li>
			</ol>
			</nav>
			<h1 class="mb-0 display-3">Shop
			</h1>
		</div>
		</div>
		<!--/.row-->
	</div>
</section>


<section class="position-relative bg-white">
	<div class="container py-9 py-lg-11 position-relative">
		<div class="row justify-content-between">
			<div class="col-md-3">
				<!--:Sidebar widget card-->
				<div class="mt-5">
					<!--:Title-->
					<h6 class="mb-4">Categories</h6>
					<!--:Collapse categories-->
					<div class="collapse-group collapse d-flex flex-column">
						<div class="collapse d-block">
							<div class="nav flex-column">
								{% for categoryFirst in category_first_list %}
								<a href="#category{{categoryFirst.id}}" class="nav-link" data-bs-toggle="collapse" aria-expanded="false">{{categoryFirst.name}}</a>
								<div class="collapse" id="category{{categoryFirst.id}}">
								<div class="nav nav-level-2 flex-column">
									{% for categorySecond in categoryFirst.categorysecond_set.all %}
									<a href="?category1={{categoryFirst.id}}&category2={{categorySecond.id}}" class="nav-link small">{{categorySecond.name}}</a>
									{% endfor %}
								</div>
								</div>
								{% endfor %}
							</div>
						</div>
					</div>
				</div>
				<!--:Sidebar widget card-->
			</div>

<!--Products column-->
<div class="col-md-9 pt-5">
<!--Products top bar-->
<div class="row mb-5 align-items-center">
  <div class="col-md-5 mb-3 mb-md-0">
	<small>Showing 1-9 of 190 items</small>
  </div>
  <div class="col-md-6 ms-auto">
	<div class="d-flex align-items-center">
		<span class="small text-muted text-end me-3 d-none d-lg-block w-100">Short by</span>
		
		<select name="sort_by" class="form-control" id="sort-by">
			<option value="id" selected> Most recent</option>
			<option value="rating_count"> Best selling</option>
			<option value="rating"> Best rated</option>
			<option value="price"> Price - Low to High</option>
			<option value="-price">Price - High to Low</option>
		</select>

	</div>
  </div>
</div>
<div class="row mb-5">
	{% for productList in product_list %}
	<div class="col-md-6 col-xl-4 mb-4">
		<!--:card-hover-expand-->
		<div class="card overflow-hidden hover-lift card-product">
		<div class="card-product-header p-3 d-block overflow-hidden position-relative">
			<a href="{% url 'product:detail' productList.id %}">
				<img src="{% static 'img/shop/products/03.jpg' %}" class="img-fluid" alt="Product">
			</a>
		</div>
		<div class="card-product-body p-3 pt-0 text-center">
			<a href="{% url 'product:detail' productList.id %}" class="h5 text-dark d-block position-relative mb-2">{{productList.name}}</a>
			<div class="card-product-body-overlay">
			<span class="card-product-price">
				<span>₱{{productList.price|intcomma}}</span>
			</span>
			<span class="card-product-view-btn">
				<a href="{% url 'product:detail' productList.id %}" class="link-underline mb-1 fw-semibold text-dark">View Details</a>
			</span>
			</div>
		</div>
		</div>
		<!--:/card product end-->
	</div>
	{% endfor %}
</div>

</div>
</div>
</div>
</section>
<section class="border-top position-relative overflow-hidden">
<div class="container py-9 position-relative">
<div class="row align-items-center">
<div class="col-md-4 border-end-md border-light text-center mb-7 mb-md-0">
<div class="mb-3">
  <i class="bx bx-store fs-1"></i>
</div>
<h6 class="mb-0">30 Day Returns</h6>
</div>
<div class="col-md-4 border-end-md border-light text-center mb-7 mb-md-0">
<div class="mb-3">
  <i class="bx bx-purchase-tag fs-1"></i>
</div>
<h6 class="mb-0">100% Handpicked</h6>
</div>
<div class="col-md-4 text-center">
<div class="mb-3">
  <i class="bx bx-package fs-1"></i>
</div>
<h6 class="mb-0">Assured Quality</h6>
</div>
</div>
</div>
</section>

<script>
$(document).ready(function() {
	const urlParams = new URLSearchParams(window.location.search);
	let sort = urlParams.get('sort');
	if (isEmpty(sort)) {
		sort = 'id';
	}
	console.log(sort);

	let element = document.getElementById("sort-by");
    element.value = sort;
});

const sort = document.querySelector('select[name=sort_by]');

sort.addEventListener('change', (event) => {
	var link = `{{request.path}}?sort=${event.target.value}`;
	location.href=link;
});
</script>

{% endblock %}